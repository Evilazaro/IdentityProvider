# Schema version for the image definition format
$schema: "1.0"
# Unique identifier for this image definition
name: identityProvider-backend-engineer
# Human-readable description of the environment purpose
description: "This image definition sets up a development environment for backend engineers."
# Base image to use from Microsoft's catalog
image: microsoftvisualstudio_visualstudioplustools_vs-2022-ent-general-win11-m365-gen2

# Installation tasks to configure the development environment
tasks:
  ##### Install common tools and utilities for backend engineering #####

  # Install PSDSCResources module for PowerShell environment configuration
  - name: ~/powershell
    description: "Configure PowerShell environment and install DSC resources"
    parameters:
      command: |
        # Set execution policy to allow running scripts for this session
        Set-ExecutionPolicy -ExecutionPolicy Bypass -Force -Scope Process
        # Install NuGet package provider required for PowerShell modules
        Install-PackageProvider -Name NuGet -Force -Scope AllUsers
        # Configure PowerShell Gallery as a trusted source
        Set-PSRepository -Name "PSGallery" -InstallationPolicy Trusted
        # Install DSC resources for system configuration
        Install-Module -Name PSDSCResources -Force -AllowClobber -Scope AllUsers

  # Install Git - distributed version control system
  - name: ~/winget
    description: "Install Git for version control and source code management"
    parameters:
      package: Git.Git

  # Install GitHub CLI - command-line tool for GitHub workflow integration
  - name: ~/winget
    description: "Install GitHub CLI for managing GitHub workflows from the command line"
    parameters:
      package: GitHub.cli

  # Install GitHub Desktop - GUI client for Git repositories
  - name: ~/winget
    description: "Install GitHub Desktop for visual Git repository management"
    parameters:
      package: GitHub.GitHubDesktop

  # Install Windows Terminal - modern command-line interface for Windows
  - name: ~/winget
    description: "Install Windows Terminal for improved command-line experience"
    parameters:
      package: Microsoft.WindowsTerminal

  ##### Install .NET tools and SDKs for backend development #####

  # Install .NET SDK 9 - development tools for creating .NET applications
  - name: ~/winget
    description: "Install .NET SDK 9 for developing .NET applications"
    parameters:
      package: Microsoft.DotNet.SDK.9

  # Install .NET Runtime 9 - runtime environment for executing .NET applications
  - name: ~/winget
    description: "Install .NET Runtime 9 for running .NET applications"
    parameters:
      package: Microsoft.DotNet.Runtime.9

  ##### Install development IDEs #####

  # Install Visual Studio Code - lightweight, extensible code editor
  - name: ~/winget
    description: "Install Visual Studio Code for lightweight code editing and development"
    parameters:
      package: Microsoft.VisualStudioCode

  # Install Visual Studio 2022 Enterprise - full-featured IDE for .NET development
  - name: ~/winget
    description: "Install Visual Studio 2022 Enterprise for comprehensive .NET development"
    parameters:
      package: Microsoft.VisualStudio.2022.Enterprise
  # Install Azure CLI - streamlined tools for Azure administrators and developers
  - name: ~/winget
    description: "Install Azure Developer CLI (azd) for simplified Azure development workflows"
    parameters:
      package: Microsoft.AzureCLI

  # Install Azure Developer CLI (azd) - streamlined developer tool for Azure projects
  - name: ~/winget
    description: "Install Azure Developer CLI (azd) for simplified Azure development workflows"
    parameters:
      package: Microsoft.Azd

  # Install Azure Storage Emulator - local development environment for Azure Storage
  - name: ~/winget
    description: "Install Azure Storage Emulator for local development with Azure Storage services"
    parameters:
      package: Microsoft.Azure.StorageEmulator

  # Install Azure Cosmos DB Emulator - local development environment for Cosmos DB
  - name: ~/winget
    description: "Install Azure Cosmos DB Emulator for local NoSQL database development"
    parameters:
      package: Microsoft.Azure.CosmosEmulator

  # Install Bicep - domain-specific language for deploying Azure resources
  - name: ~/winget
    description: "Install Bicep for declarative Azure infrastructure deployment"
    parameters:
      package: Microsoft.Bicep

  # Install Azure Data CLI - command-line tool for data solutions on Azure
  - name: ~/winget
    description: "Install Azure Data CLI for managing data resources in Azure"
    parameters:
      package: Microsoft.Azure.DataCLI

  # Install Service Bus Explorer - tool for managing and testing Azure Service Bus entities
  - name: ~/winget
    description: "Install Service Bus Explorer for interacting with Azure Service Bus messaging entities"
    parameters:
      package: paolosalvatori.ServiceBusExplorer

# User-specific tasks that can be customized
userTasks:
  # Import common engineering tools configuration - shared developer tools and utilities
  - name: ~/winget
    description: "Import common engineering tools and configurations"
    parameters:
      downloadUrl: "https://raw.githubusercontent.com/Evilazaro/DevExp-DevBox/refs/heads/main/.configuration/devcenter/workloads/common-config.dsc.yaml"

  # Import .NET Aspire configuration - cloud-native application development framework
  - name: ~/winget
    description: "Add .NET Aspire capabilities for cloud-native application development"
    parameters:
      downloadUrl: "https://raw.githubusercontent.com/Evilazaro/DevExp-DevBox/refs/heads/main/.configuration/devcenter/workloads/customizations/dotnet/aspire.dsc.yaml"

  # Import VS Code extensions and configurations for enhanced productivity
  - name: ~/winget
    description: "Configure Visual Studio Code with recommended extensions and settings"
    parameters:
      downloadUrl: "https://raw.githubusercontent.com/Evilazaro/DevExp-DevBox/refs/heads/main/.configuration/devcenter/workloads/customizations/ides/vscode.dsc.yaml"

  # Import virtualization tools for Windows development
  - name: ~/winget
    description: "Install virtualization tools for Windows development environments"
    parameters:
      downloadUrl: "https://raw.githubusercontent.com/Evilazaro/DevExp-DevBox/refs/heads/main/.configuration/devcenter/workloads/customizations/windows/virtualization.dsc.yaml"

  # Import container development tools (Docker, Kubernetes, etc.)
  - name: ~/winget
    description: "Install container tools and runtime for containerized application development"
    parameters:
      downloadUrl: "https://raw.githubusercontent.com/Evilazaro/DevExp-DevBox/refs/heads/main/.configuration/devcenter/workloads/customizations/containers/containers.dsc.yaml"

  # Import API development tools (Swagger, Postman, etc.)
  - name: ~/winget
    description: "Install API development and testing tools for backend services"
    parameters:
      downloadUrl: "https://raw.githubusercontent.com/Evilazaro/DevExp-DevBox/refs/heads/main/.configuration/devcenter/workloads/customizations/apis/apis.dsc.yaml"
