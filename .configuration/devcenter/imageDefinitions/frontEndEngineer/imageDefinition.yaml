#######################################################################################
# Identity Provider - Frontend Engineer Image Definition
# Purpose: Configures a development environment for frontend engineering tasks
# Last Updated: April 25, 2025
#######################################################################################

# Schema version for the image definition format
$schema: "1.0"

# Unique identifier for this image definition
name: identityProvider-frontend-engineer

# Human-readable description of the environment purpose
description: "This image definition sets up a development environment for frontend engineers."

# Base image to use from Microsoft's catalog
# Note: This image includes Windows 11 with basic development tools
image: microsoftvisualstudio_windowsplustools_base-win11-gen2

# Installation tasks to configure the development environment
tasks:
  #######################################################################################
  # SECTION: Core Environment Setup
  # Purpose: Install foundational tools and configure the PowerShell environment
  #######################################################################################
  
  # Install PSDSCResources module for PowerShell environment configuration
  # This enables PowerShell DSC functionality for subsequent configuration tasks
  - name: ~/powershell
    description: "Configure PowerShell environment and install DSC resources"
    parameters:
      command: |
        # Set execution policy to allow running scripts for this session
        Set-ExecutionPolicy -ExecutionPolicy Bypass -Force -Scope Process
        
        # Install NuGet package provider required for PowerShell modules
        Install-PackageProvider -Name NuGet -Force -Scope AllUsers
        
        # Configure PowerShell Gallery as a trusted source
        Set-PSRepository -Name "PSGallery" -InstallationPolicy Trusted
        
        # Install DSC resources for system configuration
        Install-Module -Name PSDSCResources -Force -AllowClobber -Scope AllUsers

  #######################################################################################
  # SECTION: Development Tools
  # Purpose: Install core development applications and utilities
  #######################################################################################

  # Install GitHub Desktop - GUI tool for Git repository management
  # Provides visual interface for commits, branches, and pull requests
  - name: ~/winget
    description: "Install GitHub Desktop for visual Git management"
    parameters:
      package: "GitHub.GitHubDesktop"

  # Install Visual Studio Code - primary IDE for frontend development
  # Lightweight editor optimized for web development languages and frameworks
  - name: ~/winget
    description: "Install Visual Studio Code for web development"
    parameters:
      package: "Microsoft.VisualStudioCode"

  # Clone the Identity Provider repository into the workspace
  # This provides immediate access to project code and resources
  - name: ~/git-clone
    description: "Clone the Identity Provider repository to the local workspace"
    parameters:
      # Source repository URL for the project code
      repositoryUrl: https://github.com/Evilazaro/IdentityProvider.git
      # Local directory where the repository will be cloned
      directory: Z:\Workspaces

  #######################################################################################
  # SECTION: Frontend Development Environment
  # Purpose: Install specialized tools for frontend engineering tasks
  #######################################################################################
  
  # Import frontend-specific development tools
  # This includes Node.js, npm, web frameworks, and frontend build tools
  - name: ~/winget
    description: "Install specialized frontend development tools"
    parameters:
      # Frontend-specific tools configuration including Node.js, npm, 
      # web frameworks, and build tools
      downloadUrl: "https://raw.githubusercontent.com/Evilazaro/DevExp-DevBox/refs/heads/main/.configuration/devcenter/workloads/common-frontend-config.dsc.yaml"
      # Local path where the configuration file will be saved
      configurationFile: "c:\\winget\\common-frontend-config.dsc.yaml"

# User-specific tasks that can be customized by individual developers
userTasks:
  #######################################################################################
  # SECTION: Optional Frontend Tools
  # Purpose: Additional tools that engineers can install based on project needs
  #######################################################################################
  
  # Import optional frontend development tools
  # This includes specialized tools for specific frontend scenarios
  # Not installed by default to keep base image lean
  - name: ~/winget
    description: "Install additional frontend-specific tools"
    parameters:
      # Contains optional tools that frontend engineers might need based on specific projects
      downloadUrl: "https://raw.githubusercontent.com/Evilazaro/DevExp-DevBox/refs/heads/main/.configuration/devcenter/workloads/common-frontend-usertasks-config.dsc.yaml"
      # Local path where the configuration file will be saved
      configurationFile: "c:\\winget\\common-frontend-usertasks-config.dsc.yaml"