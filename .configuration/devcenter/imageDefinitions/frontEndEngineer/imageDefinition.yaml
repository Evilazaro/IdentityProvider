$schema: "1.0"

name: identityProvider-frontend-engineer

description: "This image definition sets up a development environment for frontend engineers."

image: microsoftvisualstudio_windowsplustools_base-win11-gen2

tasks:
  - name: ~/powershell
    description: "Configure PowerShell environment and install DSC resources"
    parameters:
      command: |
        Set-ExecutionPolicy -ExecutionPolicy Bypass -Force -Scope Process
        Install-PackageProvider -Name NuGet -Force -Scope AllUsers
        Set-PSRepository -Name "PSGallery" -InstallationPolicy Trusted
        Install-Module -Name PSDSCResources -Force -AllowClobber -Scope AllUsers

  - name: ~/winget
    description: "Import common engineering tools and configurations"
    parameters:
      downloadUrl: "https://raw.githubusercontent.com/Evilazaro/DevExp-DevBox/refs/heads/main/.configuration/devcenter/workloads/common-config.dsc.yaml"
      configurationFile: "c:\\winget\\common-config.dsc.yaml"

  - name: ~/winget
    description: "Install GitHub Desktop for visual Git management"
    parameters:
      package: GitHub.GitHubDesktop

  - name: ~/winget
    description: "Import common engineering tools and configurations"
    parameters:
      downloadUrl: "https://raw.githubusercontent.com/Evilazaro/DevExp-DevBox/refs/heads/main/.configuration/devcenter/workloads/common-backend-config.dsc.yaml"
      configurationFile: "c:\\winget\\common-backend-config.dsc.yaml"
userTasks:
  - name: ~/winget
    description: "Install Windows virtualization features and WSL2"
    parameters:
      downloadUrl: "https://raw.githubusercontent.com/Evilazaro/DevExp-DevBox/refs/heads/main/.configuration/devcenter/workloads/customizations/windows/virtualization.dsc.yaml"
      configurationFile: "c:\\winget\\virtualization.dsc.yaml"